# СТРУКТУРА ДАННЫХ ДЛЯ WORDPRESS (HEADLESS CMS)
## Каталог строительных материалов "ДомСтрой"

---

## ОТВЕТЫ НА ВОПРОСЫ (на основе текущего проекта)

### Блок 1: Категории товаров
**1. Основные категории:**
- Цемент и бетон
- Кирпичи и блоки  
- Сталь и железо
- Инструменты и оборудование
- Древесина и пиломатериалы
- Краски и покрытия

**2. Вложенность:**
- **1 уровень** (плоская структура, как сейчас реализовано)

**Рекомендация:** Оставить плоскую структуру, так как в проекте всего 6 категорий и товаров 300-500. При необходимости расширения можно добавить подкатегории позже.

---

### Блок 2: Единицы измерения и ценообразование
**3. Единицы измерения:**
- **Разнообразные:** шт, м, м², м³, кг, т, упаковка (пачка), литры
- Примеры из текущих товаров:
  - шт (кирпич, блоки)
  - м (арматура, уголок, брус)
  - м² (фанера, краска по площади)
  - м³ (бетон)
  - кг (цемент, сухие смеси)
  - л (краски)
  - упаковка/пачка (шпатлевка)

**4. Цена:**
- **Одна цена** на товар (текущая реализация)
- Единица измерения указывается в названии товара или в specifications

**5. Валюта:**
- **Только рубли (₽)** — используется форматирование `Intl.NumberFormat("ru-RU")`

**6. Розница/опт:**
- **Только розница** (минимальная партия не требуется)
- Нет разделения на розничные/оптовые цены в текущей структуре

---

### Блок 3: Наличие и склад
**7. Наличие:**
- **Просто "в наличии / нет в наличии"** (boolean `inStock`)
- Количество на складе не отображается

**8. Склады:**
- **Один склад** (локации не указаны в проекте)

---

### Блок 4: Характеристики товаров
**9. Обязательные характеристики (что есть у большинства):**
На основе текущих данных в `specifications`:
- **Размеры** (dimensions, thickness, diameter, size)
- **Вес** (weight, weight_per_meter)
- **Прочность/марка** (strength, compressive_strength, grade, strength_class, density)
- **Марка материала** (grade: Fe500, B2.5, D500, М150, М300, B15)
- **Технические параметры** (power, voltage, setting_time, frost_resistance, water_absorption)
- **Специфические** (coverage, finish, drying_time, thermal_conductivity, adhesive_type)

**10. Производитель:**
- **Не используется** в текущей структуре
- **Рекомендация:** Добавить как ACF-поле (текстовое), не таксономию, так как брендов будет много и они не будут использоваться для навигации

**11. Варианты товара:**
- **Нет вариантов** (каждый товар — отдельная запись)

---

### Блок 5: Медиа и описание
**12. Изображения:**
- **Галерея** (массив изображений)
- В проекте: минимум 1 фото, максимум 5+ изображений на товар
- Первое изображение используется для карточки товара

**13. Видео/3D/PDF:**
- **Не используется** в текущей структуре
- **Рекомендация:** Оставить возможность добавления через ACF (file поле), но не обязательное

**14. Описание:**
- **Среднее описание** (есть `description` — полное и `shortDescription` — краткое)
- ShortDescription используется для SEO и карточек
- Description — на странице товара
- Specifications отдельно хранятся в объекте

---

### Блок 6: Фильтры
**15. Важные фильтры (приоритет):**
Текущая реализация:
1. **Категория** (обязательный)
2. **Наличие** (inStock: в наличии/нет)
3. **Цена** (сортировка: по возрастанию/убыванию)
4. **Поиск по тексту** (title, description, category)

**Рекомендации для расширения:**
- **Бренд/производитель** — не приоритет (если добавим)
- **Размеры** — можно фильтровать по ключевым характеристикам из specifications
- **Марка/класс прочности** — полезно для цемента, бетона, кирпича
- **Единица измерения** — низкий приоритет

---

### Блок 7: SEO и URL
**16. Регион:**
- **По РФ** (нет привязки к региону в проекте)

**17. Что важнее в SEO:**
- **50/50** — типы материалов и конкретные названия
- Примеры из текущих товаров: "Шпатлевка готовая DANOGIPS", "Арматура 12 мм", "Бетон М200"

**18. URL структура:**
Текущая реализация:
- Каталог: `/catalog?category=slug`
- Товар: `/product/slug`

**Рекомендация для WordPress:**
- Категория: `/catalog/category-slug` или `/category-slug`
- Товар: `/product/product-slug` (текущий вариант лучше сохранить)
- Альтернатива: `/catalog/category-slug/product-slug` (если нужна SEO-оптимизация)

---

### Блок 8: Дополнительно
**19. Похожие товары:**
- **Не реализовано** в текущей версии
- **Рекомендация:** Добавить ACF поле "related_products" (relationship) для ручного подбора похожих товаров

**20. Дополнительные данные:**
- **Срок годности** — редко нужен (можно добавить для красок, смесей)
- **Условия хранения** — низкий приоритет
- **Доставка** — не требуется (нет корзины)
- **Артикул/SKU** — рекомендуется добавить для идентификации

---

## СТРУКТУРИРОВАННЫЙ ОТЧЕТ ДЛЯ НАСТРОЙКИ WORDPRESS

---

## 1. КАТЕГОРИИ И ПОДКАТЕГОРИИ

### Таксономия: `product_category` (hierarchical: true)

**Структура (1 уровень, плоская):**

```
1. Цемент и бетон (slug: cement-beton)
2. Кирпичи и блоки (slug: kirpichi-bloki)
3. Сталь и железо (slug: stal-zhelezo)
4. Инструменты и оборудование (slug: instrumenty-oborudovanie)
5. Древесина и пиломатериалы (slug: drevesina)
6. Краски и покрытия (slug: kraski-pokrytiya)
```

**Поля категории (ACF группа "Поля категории"):**
- `category_description` (textarea) — описание категории
- `category_image` (image) — изображение для карточки категории

**Настройки таксономии:**
- `hierarchical: true` (для возможного расширения в будущем)
- `show_in_rest: true` (для REST API)
- `public: true`
- `rewrite: { 'slug' => 'catalog', 'with_front' => false }`

---

## 2. МОДЕЛЬ ДАННЫХ ТОВАРОВ

### Custom Post Type: `product`

**Стандартные поля WordPress:**
- `post_title` — Название товара
- `post_content` — Полное описание (editor)
- `post_excerpt` — Краткое описание (shortDescription)
- `post_name` (slug) — URL-адрес товара
- `post_status` — Статус публикации
- `post_type` — `product`

**Рекомендуемые стандартные поля:**
- `menu_order` — для сортировки товаров внутри категории

---

## 3. ТАКСОНОМИИ VS ACF-ПОЛЯ

### ТАКСОНОМИИ (для фильтрации и навигации):

1. **`product_category`** (hierarchical)
   - Назначение: основная категория товара
   - Использование: фильтрация, навигация, группировка

### ACF-ПОЛЯ (для метаданных и характеристик):

#### Группа ACF: "Основные поля товара" (`product_main_fields`)

**Обязательные поля:**

1. **Цена и наличие:**
   - `price` (text) — Цена в рублях (строка, формат: "1 200" или "650")
   - `price_unit` (text) — Единица измерения (шт, м, м², м³, кг, т, л, упаковка)
   - `in_stock` (true_false) — В наличии (boolean)

2. **Изображения:**
   - `product_images` (gallery) — Галерея изображений (минимум 1)

3. **Характеристики:**
   - `specifications` (repeater) — Характеристики товара
     - `spec_key` (text) — Название характеристики (например: "diameter", "weight", "strength")
     - `spec_value` (text) — Значение характеристики (например: "12 мм", "50 кг", "М300")

**Желательные поля:**

4. **Дополнительная информация:**
   - `manufacturer` (text) — Производитель/бренд (опционально)
   - `sku` (text) — Артикул товара
   - `related_products` (post_object, multiple) — Похожие товары (ручной подбор)

5. **Медиа (опционально):**
   - `product_video` (file/url) — Видео товара
   - `product_pdf` (file) — PDF с техническими характеристиками

---

## 4. ПРАВИЛА URL/SLUG

### Структура URL:

**Для товаров:**
```
/product/{product-slug}
```
Примеры:
- `/product/portlandcement-50kg`
- `/product/armatura-12mm`
- `/product/betonnyy-blok-190x190x390`

**Для категорий (опционально, если нужны отдельные страницы):**
```
/catalog/{category-slug}
```
Примеры:
- `/catalog/cement-beton`
- `/catalog/kirpichi-bloki`

### Правила формирования slug:

1. **Транслитерация** названия товара на латиницу
2. **Лowercase** (все в нижнем регистре)
3. **Дефисы** вместо пробелов и специальных символов
4. **Уникальность** — проверка на конфликты при создании
5. **SEO-friendly** — включение ключевых слов (тип товара, размер, марка)
6. **Лаконичность** — не более 100 символов

**Примеры slug на основе текущих товаров:**
- "Шпатлевка готовая DANOGIPS SuperFinish" → `shpatlevka-gotovaya-danogips-superfinish`
- "Арматура 12 мм" → `armatura-12mm`
- "Бетонный блок 190×190×390 мм" → `betonnyy-blok-190x190x390mm`

### Настройка permalink в WordPress:

```php
// В functions.php или плагине
add_action('init', function() {
    add_rewrite_rule(
        '^product/([^/]+)/?$',
        'index.php?post_type=product&name=$matches[1]',
        'top'
    );
});
```

---

## 5. SEO-ШАБЛОНЫ

### Для товаров (product):

**Title (до 60 символов):**
```
{Название товара} - ДомСтрой
```
Пример: `Шпатлевка готовая DANOGIPS SuperFinish - ДомСтрой`

**Meta Description (до 160 символов):**
```
{shortDescription} Цена {price} ₽. ДомСтрой.
```
Пример: `Готовая шпатлевка DANOGIPS SuperFinish 28 кг для финишной отделки стен и потолков. Идеально гладкая поверхность, удобна в нанесении. Цена 650 ₽. ДомСтрой.`

**Keywords:**
```
{Название товара}, {Категория}, строительные материалы, {Производитель (если есть)}, купить {Название товара}
```
Пример: `Шпатлевка DANOGIPS, Цемент и бетон, строительные материалы, DANOGIPS, купить шпатлевку`

**Open Graph:**
- `og:title` — как Title выше
- `og:description` — как Meta Description выше
- `og:image` — первое изображение из галереи
- `og:type` — `product`
- `og:url` — полный URL товара

**Schema.org (JSON-LD):**
```json
{
  "@context": "https://schema.org/",
  "@type": "Product",
  "name": "{Название товара}",
  "description": "{shortDescription}",
  "image": ["{URL изображений}"],
  "brand": {
    "@type": "Brand",
    "name": "{Производитель или ДомСтрой}"
  },
  "offers": {
    "@type": "Offer",
    "url": "{URL товара}",
    "priceCurrency": "RUB",
    "price": "{Цена без пробелов}",
    "availability": "https://schema.org/{InStock или OutOfStock}",
    "priceValidUntil": "{Дата + 1 год}"
  },
  "category": "{Категория}"
}
```

---

### Для категорий (product_category):

**Title:**
```
{Название категории} - Каталог строительных материалов | ДомСтрой
```
Пример: `Цемент и бетон - Каталог строительных материалов | ДомСтрой`

**Meta Description:**
```
{category_description}. Широкий выбор товаров в категории {Название категории}. Цены от {min_price} ₽. ДомСтрой.
```
Пример: `Высококачественный цемент и готовые бетонные смеси. Широкий выбор товаров в категории Цемент и бетон. Цены от 520 ₽. ДомСтрой.`

**Keywords:**
```
{Название категории}, строительные материалы, {Название категории} купить, {Название категории} цена
```

**Schema.org (JSON-LD):**
```json
{
  "@context": "https://schema.org/",
  "@type": "CollectionPage",
  "name": "{Название категории}",
  "description": "{category_description}",
  "url": "{URL категории}"
}
```

---

## 6. ПРИМЕРЫ 5 ТОВАРОВ В ТАБЛИЦЕ

| ID | Название | Slug | Категория | Цена | Ед. изм. | В наличии | Артикул |
|----|----------|------|-----------|------|----------|-----------|---------|
| 1 | Шпатлевка готовая DANOGIPS SuperFinish (28кг/17л) | shpatlevka-gotovaya-danogips-superfinish | Цемент и бетон | 650 | упаковка | Нет | SKU-001 |
| 2 | Бетонный блок 190×190×390 мм | betonnyy-blok-190x190x390 | Кирпичи и блоки | 85 | шт | Нет | SKU-002 |
| 3 | Арматура 12 мм | armatura-12mm | Сталь и железо | 1200 | м | Да | SKU-003 |
| 4 | Профессиональная дрель 800 Вт | professionalnaya-drel-800w | Инструменты и оборудование | 8900 | шт | Да | SKU-004 |
| 5 | Фанера 18 мм (1220×2440 мм) | fanera-18mm-1220x2440 | Древесина и пиломатериалы | 2150 | лист | Да | SKU-005 |

### Детализация характеристик (specifications):

**Товар 1: Шпатлевка DANOGIPS**
```json
{
  "weight": "28 кг",
  "volume": "17 л",
  "packaging": "33 шт/поддон",
  "application": "Финишная отделка",
  "surface": "Стены и потолки"
}
```

**Товар 2: Бетонный блок**
```json
{
  "dimensions": "190 × 190 × 390 мм",
  "compressive_strength": "4.5 МПа",
  "weight": "10.5 кг",
  "density": "1450 кг/м³",
  "water_absorption": "8%"
}
```

**Товар 3: Арматура 12 мм**
```json
{
  "diameter": "12 мм",
  "yield_strength": "500 МПа",
  "tensile_strength": "650 МПа",
  "weight_per_meter": "0.888 кг",
  "grade": "Fe500",
  "length": "11.7 м"
}
```

**Товар 4: Дрель 800 Вт**
```json
{
  "power": "800 Вт",
  "no_load_speed": "0–3000 об/мин",
  "chuck_capacity": "13 мм",
  "weight": "2.5 кг",
  "voltage": "220 В"
}
```

**Товар 5: Фанера 18 мм**
```json
{
  "thickness": "18 мм",
  "dimensions": "1220 × 2440 мм",
  "grade": "BB",
  "weight": "23 кг",
  "adhesive_type": "Фенолформальдегидная",
  "wood_type": "Хвойные породы"
}
```

---

## 7. СПИСОК ОБЯЗАТЕЛЬНЫХ И ЖЕЛАТЕЛЬНЫХ ПОЛЕЙ

### ОБЯЗАТЕЛЬНЫЕ ПОЛЯ:

#### WordPress стандартные:
- ✅ `post_title` — Название товара
- ✅ `post_name` (slug) — URL-адрес
- ✅ `post_excerpt` — Краткое описание (shortDescription)
- ✅ `post_content` — Полное описание (description)
- ✅ `post_status` — Статус публикации

#### ACF поля:
- ✅ `price` (text) — Цена (обязательно, но может быть "Цена по запросу")
- ✅ `price_unit` (text) — Единица измерения
- ✅ `in_stock` (true_false) — В наличии
- ✅ `product_images` (gallery) — Галерея (минимум 1 изображение)
- ✅ `specifications` (repeater) — Характеристики (минимум 1 характеристика)
  - ✅ `spec_key` (text)
  - ✅ `spec_value` (text)

#### Таксономии:
- ✅ `product_category` — Категория товара (одна обязательная)

---

### ЖЕЛАТЕЛЬНЫЕ ПОЛЯ:

#### ACF поля:
- ⚪ `sku` (text) — Артикул товара
- ⚪ `manufacturer` (text) — Производитель/бренд
- ⚪ `related_products` (post_object, multiple) — Похожие товары
- ⚪ `product_video` (file/url) — Видео товара
- ⚪ `product_pdf` (file) — PDF с характеристиками
- ⚪ `expiry_date` (date_picker) — Срок годности (для красок, смесей)
- ⚪ `storage_conditions` (textarea) — Условия хранения

#### SEO поля (можно через плагин Yoast/Rank Math):
- ⚪ `meta_title` — Кастомный SEO title (если отличается от post_title)
- ⚪ `meta_description` — Кастомный SEO description
- ⚪ `meta_keywords` — Ключевые слова
- ⚪ `og_image` — Кастомное Open Graph изображение

---

## ДОПОЛНИТЕЛЬНЫЕ РЕКОМЕНДАЦИИ

### 1. REST API Endpoints для фронтенда:

WordPress автоматически создаст:
- `GET /wp-json/wp/v2/product` — Список товаров
- `GET /wp-json/wp/v2/product/{id}` — Один товар
- `GET /wp-json/wp/v2/product_category` — Категории
- `GET /wp-json/wp/v2/product_category/{id}` — Одна категория

**Параметры запроса:**
- `?per_page=9` — Пагинация
- `?product_category={id}` — Фильтр по категории
- `?search={query}` — Поиск
- `?meta_key=in_stock&meta_value=1` — Фильтр по наличию

### 2. Плагины для WordPress:

**Обязательные:**
- `Advanced Custom Fields (ACF)` — для полей товаров
- `ACF to REST API` — для экспорта ACF полей в REST API
- `Custom Post Type UI` (опционально, если настраивать CPT вручную)

**Желательные:**
- `Yoast SEO` или `Rank Math` — для SEO оптимизации
- `WP REST API Filter Fields` — для выборочной выборки полей
- `Disable Comments` — отключение комментариев для товаров

### 3. Настройка производительности:

- Включить кеширование REST API (через плагин)
- Оптимизировать изображения (WebP формат)
- Использовать lazy loading для изображений
- Настроить пагинацию (9 товаров на страницу, как в проекте)

### 4. Миграция данных:

При переносе данных из текущей структуры (products.ts) в WordPress:
1. Создать категории через импорт или вручную
2. Импортировать товары через CSV импорт или через REST API
3. Маппинг полей:
   - `title` → `post_title`
   - `slug` → `post_name`
   - `shortDescription` → `post_excerpt`
   - `description` → `post_content`
   - `category` → `product_category` (по slug или названию)
   - `price` → ACF `price`
   - `images` → ACF `product_images` (gallery)
   - `specifications` → ACF `specifications` (repeater)
   - `inStock` → ACF `in_stock`

---

## ИТОГОВЫЙ ЧЕКЛИСТ ДЛЯ РАЗРАБОТЧИКА:

- [ ] Создать Custom Post Type `product`
- [ ] Создать таксономию `product_category` (hierarchical)
- [ ] Настроить ACF группу "Поля товара" с обязательными полями
- [ ] Настроить permalink структуру (`/product/{slug}`)
- [ ] Включить REST API для CPT и таксономий
- [ ] Установить плагин `ACF to REST API`
- [ ] Настроить SEO плагин (Yoast/Rank Math)
- [ ] Создать 6 категорий товаров
- [ ] Импортировать тестовые товары (5-10 штук)
- [ ] Проверить REST API endpoints
- [ ] Настроить CORS (если фронт на другом домене)
- [ ] Протестировать фильтрацию и поиск через API

---

**Версия документа:** 1.0  
**Дата создания:** 2024  
**Проект:** ДомСтрой — Каталог строительных материалов
